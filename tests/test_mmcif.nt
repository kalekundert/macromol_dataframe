test_extract_dataframe:
  -
    id: empty
    mmcif:
      > data_1abc
    prefix: mock_loop
    schema:
      a: Column('a')
      b: Column('b')
    expected:
      > pl.DataFrame([], {'a': str, 'b': str})
  -
    id: pair
    mmcif:
      > data_1abc
      > _mock_loop.a 1
      > _mock_loop.b 2
    prefix: mock_loop
    schema:
      a: Column('a')
      b: Column('b')
    expected:
      > pl.DataFrame([
      >     dict(a='1', b='2'),
      > ])
  -
    id: loop
    mmcif:
      > data_1abc
      > loop_
      > _mock_loop.a
      > _mock_loop.b
      > 1 2
      > 3 4
    prefix: mock_loop
    schema:
      a: Column('a')
      b: Column('b')
    expected:
      > pl.DataFrame([
      >     dict(a='1', b='2'),
      >     dict(a='3', b='4'),
      > ])
  -
    id: required
    mmcif:
      > data_1abc
      > loop_
      > _mock_loop.a
      > _mock_loop.b
      > 1 2
      > 3 4
    prefix: mock_loop
    schema:
      a: Column('a')
      b: Column('b')
      c: Column('c', required=True)
    error:
      type: mmdf.MmcifError
      message:
        - missing required column(s)
        - category: _mock_loop.*
        - missing column(s): ['c']
  -
    id: optional
    mmcif:
      > data_1abc
      > loop_
      > _mock_loop.a
      > _mock_loop.b
      > 1 2
      > 3 4
    prefix: mock_loop
    schema:
      a: Column('a')
      b: Column('b')
      c: Column('c')
    expected:
      > pl.DataFrame([
      >     dict(a='1', b='2', c=None),
      >     dict(a='3', b='4', c=None),
      > ], {'a': str, 'b': str, 'c': str})
  -
    id: cast
    mmcif:
      > data_1abc
      > loop_
      > _mock_loop.a
      > _mock_loop.b
      > 1 2
      > 3 4
    prefix: mock_loop
    schema:
      a: Column('a', dtype=int)
      b: Column('b', dtype=float)
    expected:
      > pl.DataFrame([
      >     dict(a=1, b=2.0),
      >     dict(a=3, b=4.0),
      > ])
  -
    id: cast-missing
    mmcif:
      > data_1abc
      > loop_
      > _mock_loop.a
      > _mock_loop.b
      > 1 2
      > 3 .
      > 4 ?
    prefix: mock_loop
    schema:
      a: Column('a', dtype=int)
      b: Column('b', dtype=float)
    expected:
      > pl.DataFrame([
      >     dict(a=1, b=2.0),
      >     dict(a=3, b=None),
      >     dict(a=4, b=None),
      > ])
  -
    id: drop-missing
    mmcif:
      > data_1abc
      > loop_
      > _mock_loop.a
      > _mock_loop.b
      > 1 2
      > . .
      > ? ?
      > . ?
      > ? .
    prefix: mock_loop
    schema:
      a: Column('a')
      b: Column('b')
    expected:
      > pl.DataFrame([
      >     dict(a='1', b='2'),
      > ])
  -
    id: alias
    mmcif:
      > data_1abc
      > loop_
      > _mock_loop.a
      > _mock_loop.b
      > 1 2
      > 3 4
    prefix: mock_loop
    schema:
      alpha: Column('a')
      beta: Column('b')
    expected:
      > pl.DataFrame([
      >     dict(alpha='1', beta='2'),
      >     dict(alpha='3', beta='4'),
      > ])

test_read_mmcif:
  -
    id: asym-atoms
    mmcif:
      > data_9XYZ
      > # 
      > loop_
      > _atom_site.auth_asym_id 
      > _atom_site.label_asym_id 
      > _atom_site.label_entity_id 
      > _atom_site.label_alt_id 
      > _atom_site.label_seq_id 
      > _atom_site.auth_seq_id 
      > _atom_site.pdbx_PDB_ins_code 
      > _atom_site.label_comp_id 
      > _atom_site.label_atom_id 
      > _atom_site.type_symbol 
      > _atom_site.Cartn_x 
      > _atom_site.Cartn_y 
      > _atom_site.Cartn_z 
      > _atom_site.occupancy 
      > _atom_site.B_iso_or_equiv 
      > AAA A 1 . 1 1 ? GLY N  N -1.195  0.201 -0.206 1.00 0.00
      > AAA A 1 . 1 1 ? GLY CA C  0.230  0.318 -0.502 1.00 0.00
      > AAA A 1 . 1 1 ? GLY C  C  1.059 -0.390  0.542 1.00 0.00
      > AAA A 1 . 1 1 ? GLY O  O  0.545 -0.975  1.499 1.00 0.00
    pdb_id: 9XYZ
    asym_atoms:
      > model_id,chain_id,subchain_id,entity_id,alt_id,seq_id,seq_label,comp_id,atom_id,element,x,y,z,occupancy,b_factor
      > ,AAA,A,1,,1,1,GLY,N, N,-1.195, 0.201,-0.206,1.00,0.00
      > ,AAA,A,1,,1,1,GLY,CA,C, 0.230, 0.318,-0.502,1.00,0.00
      > ,AAA,A,1,,1,1,GLY,C, C, 1.059,-0.390, 0.542,1.00,0.00
      > ,AAA,A,1,,1,1,GLY,O, O, 0.545,-0.975, 1.499,1.00,0.00
    assembly_gen:
      > pl.DataFrame([
      >     dict(assembly_id='1', subchain_ids=['A'], oper_ids=[['1']]),
      > ])
    oper_map:
      1:
        > 1 0 0 0
        > 0 1 0 0
        > 0 0 1 0
        > 0 0 0 1
    entities:
      > id type mw
  -
    id: asym-atoms-seq-label-3b9f
    mmcif:
      > data_3B9F
      > # 
      > loop_
      > _atom_site.group_PDB 
      > _atom_site.id 
      > _atom_site.type_symbol 
      > _atom_site.label_atom_id 
      > _atom_site.label_alt_id 
      > _atom_site.label_comp_id 
      > _atom_site.label_asym_id 
      > _atom_site.label_entity_id 
      > _atom_site.label_seq_id 
      > _atom_site.pdbx_PDB_ins_code 
      > _atom_site.Cartn_x 
      > _atom_site.Cartn_y 
      > _atom_site.Cartn_z 
      > _atom_site.occupancy 
      > _atom_site.B_iso_or_equiv 
      > _atom_site.pdbx_formal_charge 
      > _atom_site.auth_seq_id 
      > _atom_site.auth_comp_id 
      > _atom_site.auth_asym_id 
      > _atom_site.auth_atom_id 
      > _atom_site.pdbx_PDB_model_num 
      > ATOM   1    N N   . SER A 1 4   R -34.407 34.815  -63.204 1.00 32.04 ? 1    SER L N   1 
      > ATOM   2    C CA  . SER A 1 4   R -34.478 34.039  -61.928 1.00 29.63 ? 1    SER L CA  1 
      > ATOM   3    C C   . SER A 1 4   R -34.909 34.931  -60.771 1.00 30.25 ? 1    SER L C   1 
      > ATOM   4    O O   . SER A 1 4   R -34.085 35.625  -60.167 1.00 30.37 ? 1    SER L O   1 
      > ATOM   5    C CB  . SER A 1 4   R -33.117 33.414  -61.613 1.00 31.06 ? 1    SER L CB  1 
      > ATOM   6    O OG  . SER A 1 4   R -33.170 32.694  -60.394 1.00 24.65 ? 1    SER L OG  1 
      > ATOM   7    N N   . GLU A 1 5   Q -36.200 34.899  -60.456 1.00 29.35 ? 1    GLU L N   1 
      > ATOM   8    C CA  . GLU A 1 5   Q -36.747 35.722  -59.382 1.00 29.58 ? 1    GLU L CA  1 
      > ATOM   9    C C   . GLU A 1 5   Q -36.408 35.187  -57.993 1.00 27.19 ? 1    GLU L C   1 
      > ATOM   10   O O   . GLU A 1 5   Q -36.603 34.009  -57.697 1.00 25.98 ? 1    GLU L O   1 
      > ATOM   11   C CB  . GLU A 1 5   Q -38.268 35.843  -59.525 1.00 32.27 ? 1    GLU L CB  1 
      > ATOM   12   C CG  . GLU A 1 5   Q -39.022 34.550  -59.270 1.00 39.28 ? 1    GLU L CG  1 
      > ATOM   13   C CD  . GLU A 1 5   Q -40.524 34.704  -59.424 1.00 42.90 ? 1    GLU L CD  1 
      > ATOM   14   O OE1 . GLU A 1 5   Q -41.092 35.645  -58.825 1.00 45.81 ? 1    GLU L OE1 1 
      > ATOM   15   O OE2 . GLU A 1 5   Q -41.136 33.879  -60.137 1.00 45.28 ? 1    GLU L OE2 1 
    pdb_id: 3B9F
    asym_atoms:
      > model_id,chain_id,subchain_id,entity_id,alt_id,seq_id,seq_label,comp_id,atom_id,element,x,y,z,occupancy,b_factor
      > 1,L,A,1,,4,1R,SER,N,N,-34.407,34.815,-63.204,1.00,32.04
      > 1,L,A,1,,4,1R,SER,CA,C,-34.478,34.039,-61.928,1.00,29.63
      > 1,L,A,1,,4,1R,SER,C,C,-34.909,34.931,-60.771,1.00,30.25
      > 1,L,A,1,,4,1R,SER,O,O,-34.085,35.625,-60.167,1.00,30.37
      > 1,L,A,1,,4,1R,SER,CB,C,-33.117,33.414,-61.613,1.00,31.06
      > 1,L,A,1,,4,1R,SER,OG,O,-33.170,32.694,-60.394,1.00,24.65
      > 1,L,A,1,,5,1Q,GLU,N,N,-36.200,34.899,-60.456,1.00,29.35
      > 1,L,A,1,,5,1Q,GLU,CA,C,-36.747,35.722,-59.382,1.00,29.58
      > 1,L,A,1,,5,1Q,GLU,C,C,-36.408,35.187,-57.993,1.00,27.19
      > 1,L,A,1,,5,1Q,GLU,O,O,-36.603,34.009,-57.697,1.00,25.98
      > 1,L,A,1,,5,1Q,GLU,CB,C,-38.268,35.843,-59.525,1.00,32.27
      > 1,L,A,1,,5,1Q,GLU,CG,C,-39.022,34.550,-59.270,1.00,39.28
      > 1,L,A,1,,5,1Q,GLU,CD,C,-40.524,34.704,-59.424,1.00,42.90
      > 1,L,A,1,,5,1Q,GLU,OE1,O,-41.092,35.645,-58.825,1.00,45.81
      > 1,L,A,1,,5,1Q,GLU,OE2,O,-41.136,33.879,-60.137,1.00,45.28
    assembly_gen:
      > pl.DataFrame([
      >     dict(assembly_id='1', subchain_ids=['A'], oper_ids=[['1']]),
      > ])
    oper_map:
      1:
        > 1 0 0 0
        > 0 1 0 0
        > 0 0 1 0
        > 0 0 0 1
    entities:
      > id type mw
  -
    id: assemblies-2gtl
    mmcif: pdb/2gtl.cif.gz
    pdb_id: 2GTL
    assemblies:
      > pl.DataFrame([
      >     dict(
      >         id='1',
      >         details='complete point assembly',
      >         polymer_count=180,
      >     ),
      >     dict(
      >         id='2',
      >         details='point asymmetric unit',
      >         polymer_count=15,
      >     ),
      >     dict(
      >         id='3',
      >         details='point asymmetric unit, std point frame',
      >         polymer_count=15,
      >     ),
      >     dict(
      >         id='4',
      >         details='crystal asymmetric unit',
      >         polymer_count=360,
      >     ),
      > ])
    assembly_gen:
      > pl.DataFrame([
      >     dict(
      >         assembly_id='1',
      >         subchain_ids=[
      >             'A', 'B', 'C', 'D', 'E', 'F', 'G', 'H', 'I', 'J', 'K', 'L', 
      >             'M', 'N', 'O', 'P', 'Q', 'R', 'S', 'T', 'U', 'V', 'W', 'X', 
      >             'Y', 'Z', 'AA', 'BA', 'CA', 'DA', 'EA', 'FA', 'GA', 'HA', 
      >             'IA', 'JA', 'KA', 'LA', 'MA', 'NA', 'OA', 'PA', 'QA', 'RA',
      >         ],
      >         oper_ids=[
      >             ['1'], ['2'], ['3'], ['4'], ['5'], ['6'], ['7'], ['8'], 
      >             ['9'], ['10'], ['11'], ['12'],
      >         ],
      >     ),
      >     dict(
      >         assembly_id='2',
      >         subchain_ids=[
      >             'A', 'B', 'C', 'D', 'E', 'F', 'G', 'H', 'I', 'J', 'K', 'L', 
      >             'M', 'N', 'O', 'P', 'Q', 'R', 'S', 'T', 'U', 'V', 'W', 'X', 
      >             'Y', 'Z', 'AA', 'BA', 'CA', 'DA', 'EA', 'FA', 'GA', 'HA', 
      >             'IA', 'JA', 'KA', 'LA', 'MA', 'NA', 'OA', 'PA', 'QA', 'RA',
      >         ],
      >         oper_ids=[['1']],
      >     ),
      >     dict(
      >         assembly_id='3',
      >         subchain_ids=[
      >             'A', 'B', 'C', 'D', 'E', 'F', 'G', 'H', 'I', 'J', 'K', 'L', 
      >             'M', 'N', 'O', 'P', 'Q', 'R', 'S', 'T', 'U', 'V', 'W', 'X', 
      >             'Y', 'Z', 'AA', 'BA', 'CA', 'DA', 'EA', 'FA', 'GA', 'HA', 
      >             'IA', 'JA', 'KA', 'LA', 'MA', 'NA', 'OA', 'PA', 'QA', 'RA',
      >         ],
      >         oper_ids=[['P']],
      >     ),
      >     dict(
      >         assembly_id='4',
      >         subchain_ids=[
      >             'A', 'B', 'C', 'D', 'E', 'F', 'G', 'H', 'I', 'J', 'K', 'L', 
      >             'M', 'N', 'O', 'P', 'Q', 'R', 'S', 'T', 'U', 'V', 'W', 'X', 
      >             'Y', 'Z', 'AA', 'BA', 'CA', 'DA', 'EA', 'FA', 'GA', 'HA', 
      >             'IA', 'JA', 'KA', 'LA', 'MA', 'NA', 'OA', 'PA', 'QA', 'RA',
      >         ],
      >         oper_ids=[
      >             ['X0','1'], ['X0','2'], ['X0','3'], ['X0','4'], ['X0','5'], 
      >             ['X0','6'], ['X0','7'], ['X0','8'], ['X0','9'], 
      >             ['X0','10'], ['X0','11'], ['X0','12'],
      >             ['X1','1'], ['X1','2'], ['X1','3'], ['X1','4'], ['X1','5'], 
      >             ['X1','6'], ['X1','7'], ['X1','8'], ['X1','9'], 
      >             ['X1','10'], ['X1','11'], ['X1','12'], 
      >         ],
      >     ),
      > ])
    entities:
      > id type        mw
      > 1  polymer     17566.990
      > 2  polymer     16268.229
      > 3  polymer     17331.793
      > 4  polymer     15988.263
      > 5  polymer     24936.734
      > 6  polymer     25057.027
      > 7  polymer     24486.023
      > 8  non-polymer 28.010
      > 9  non-polymer 616.487
      > 10 non-polymer 40.078
      > 11 non-polymer 65.409
  -
    id: assembly-gen
    mmcif:
      > data_9XYZ
      > # 
      > loop_
      > _pdbx_struct_assembly_gen.assembly_id
      > _pdbx_struct_assembly_gen.asym_id_list
      > _pdbx_struct_assembly_gen.oper_expression
      > 1 A,B 1,2
      > 2 C   1,2
      >
      > # 
      > loop_
      > _pdbx_struct_oper_list.id 
      > _pdbx_struct_oper_list.type 
      > _pdbx_struct_oper_list.name 
      > _pdbx_struct_oper_list.symmetry_operation 
      > _pdbx_struct_oper_list.matrix[1][1] 
      > _pdbx_struct_oper_list.matrix[1][2] 
      > _pdbx_struct_oper_list.matrix[1][3] 
      > _pdbx_struct_oper_list.vector[1] 
      > _pdbx_struct_oper_list.matrix[2][1] 
      > _pdbx_struct_oper_list.matrix[2][2] 
      > _pdbx_struct_oper_list.matrix[2][3] 
      > _pdbx_struct_oper_list.vector[2] 
      > _pdbx_struct_oper_list.matrix[3][1] 
      > _pdbx_struct_oper_list.matrix[3][2] 
      > _pdbx_struct_oper_list.matrix[3][3] 
      > _pdbx_struct_oper_list.vector[3] 
      > 1 'identity operation'         1_555 x,y,z   1.0000000000 0.0000000000 0.0000000000 0.0000000000 0.0000000000 1.0000000000  
      > 0.0000000000 0.0000000000 0.0000000000 0.0000000000 1.0000000000  0.0000000000 
      > 2 'crystal symmetry operation' 4_555 x,-y,-z 1.0000000000 0.0000000000 0.0000000000 0.0000000000 0.0000000000 -1.0000000000 
      > 0.0000000000 0.0000000000 0.0000000000 0.0000000000 -1.0000000000 0.0000000000 
      > # 
      > loop_
      > _atom_site.auth_asym_id 
      > _atom_site.label_asym_id 
      > _atom_site.label_entity_id 
      > _atom_site.label_alt_id 
      > _atom_site.label_seq_id 
      > _atom_site.auth_seq_id 
      > _atom_site.label_comp_id 
      > _atom_site.label_atom_id 
      > _atom_site.type_symbol 
      > _atom_site.Cartn_x 
      > _atom_site.Cartn_y 
      > _atom_site.Cartn_z 
      > _atom_site.occupancy 
      > _atom_site.B_iso_or_equiv 
      > AAA A 1 . 1 1 GLY N  N -1.195  0.201 -0.206 1.00 0.00
      > AAA A 1 . 1 1 GLY CA C  0.230  0.318 -0.502 1.00 0.00
      > AAA A 1 . 1 1 GLY C  C  1.059 -0.390  0.542 1.00 0.00
      > AAA A 1 . 1 1 GLY O  O  0.545 -0.975  1.499 1.00 0.00
    pdb_id: 9XYZ
    asym_atoms:
      > model_id,chain_id,subchain_id,entity_id,alt_id,seq_id,seq_label,comp_id,atom_id,element,x,y,z,occupancy,b_factor
      > ,AAA,A,1,,1,1,GLY,N, N,-1.195, 0.201,-0.206,1.00,0.00
      > ,AAA,A,1,,1,1,GLY,CA,C, 0.230, 0.318,-0.502,1.00,0.00
      > ,AAA,A,1,,1,1,GLY,C, C, 1.059,-0.390, 0.542,1.00,0.00
      > ,AAA,A,1,,1,1,GLY,O, O, 0.545,-0.975, 1.499,1.00,0.00
    assembly_gen:
      > pl.DataFrame([
      >     dict(assembly_id='1', subchain_ids=['A', 'B'], oper_ids=[['1'], ['2']]),
      >     dict(assembly_id='2', subchain_ids=['C'], oper_ids=[['1'], ['2']]),
      > ])
    oper_map:
      1:
        > 1  0  0  0
        > 0  1  0  0
        > 0  0  1  0
        > 0  0  0  1
      2:
        > 1  0  0  0
        > 0 -1  0  0
        > 0  0 -1  0
        > 0  0  0  1
    entities:
      > id type mw
  -
    id: entities
    mmcif:
      > data_9XYZ
      > # 
      > loop_
      > _atom_site.auth_asym_id 
      > _atom_site.label_asym_id 
      > _atom_site.label_entity_id 
      > _atom_site.label_alt_id 
      > _atom_site.label_seq_id 
      > _atom_site.auth_seq_id 
      > _atom_site.label_comp_id 
      > _atom_site.label_atom_id 
      > _atom_site.type_symbol 
      > _atom_site.Cartn_x 
      > _atom_site.Cartn_y 
      > _atom_site.Cartn_z 
      > _atom_site.occupancy 
      > _atom_site.B_iso_or_equiv 
      > AAA A 1 . 1 1 GLY N  N -1.195  0.201 -0.206 1.00 0.00
      > AAA A 1 . 1 1 GLY CA C  0.230  0.318 -0.502 1.00 0.00
      > AAA A 1 . 1 1 GLY C  C  1.059 -0.390  0.542 1.00 0.00
      > AAA A 1 . 1 1 GLY O  O  0.545 -0.975  1.499 1.00 0.00
      > #
      > loop_
      > _entity.id 
      > _entity.type 
      > _entity.formula_weight 
      > 1 polymer     15785.705
      > 2 non-polymer 39.098
      > 3 water       18.015
      > # 
      > loop_
      > _entity_poly.entity_id 
      > _entity_poly.type 
      > _entity_poly.nstd_linkage 
      > _entity_poly.nstd_monomer 
      > _entity_poly.pdbx_seq_one_letter_code 
      > _entity_poly.pdbx_seq_one_letter_code_can 
      > _entity_poly.pdbx_strand_id 
      > 1 'polypeptide(L)' no no  
      > ;MEKPYKCPECGKSFSQSSNLQKHQRTHTGEKPYKCPECGKSFSQSSDLQKHQRTHTGEKPYKCPECGKSFSRSDHLSRHQ
      > RTHQNKK
      > ;
      > ;MEKPYKCPECGKSFSQSSNLQKHQRTHTGEKPYKCPECGKSFSQSSDLQKHQRTHTGEKPYKCPECGKSFSRSDHLSRHQ
      > RTHQNKK
      > ;
      > A
    pdb_id: 9XYZ
    asym_atoms:
      > model_id,chain_id,subchain_id,entity_id,alt_id,seq_id,seq_label,comp_id,atom_id,element,x,y,z,occupancy,b_factor
      > ,AAA,A,1,,1,1,GLY,N, N,-1.195, 0.201,-0.206,1.00,0.00
      > ,AAA,A,1,,1,1,GLY,CA,C, 0.230, 0.318,-0.502,1.00,0.00
      > ,AAA,A,1,,1,1,GLY,C, C, 1.059,-0.390, 0.542,1.00,0.00
      > ,AAA,A,1,,1,1,GLY,O, O, 0.545,-0.975, 1.499,1.00,0.00
    assembly_gen:
      > pl.DataFrame([
      >     dict(assembly_id='1', subchain_ids=['A'], oper_ids=[['1']]),
      > ])
    oper_map:
      1:
        > 1 0 0 0
        > 0 1 0 0
        > 0 0 1 0
        > 0 0 0 1
    entities:
      > id type        mw
      > 1  polymer     15785.705
      > 2  non-polymer 39.098
      > 3  water       18.015
    polymers:
      > pl.DataFrame([
      >     dict(
      >         entity_id='1',
      >         strand_ids=['A'],
      >         type='polypeptide(L)',
      >         sequence='MEKPYKCPECGKSFSQSSNLQKHQRTHTGEKPYKCPECGKSFSQSSDLQKHQRTHTGEKPYKCPECGKSFSRSDHLSRHQRTHQNKK',
      >         sequence_canonical='MEKPYKCPECGKSFSQSSNLQKHQRTHTGEKPYKCPECGKSFSQSSDLQKHQRTHTGEKPYKCPECGKSFSRSDHLSRHQRTHQNKK',
      >         has_nonstandard_linkage=False,
      >         has_nonstandard_monomer=False,
      >     ),
      > ])

test_read_biological_assembly:
  -
    id: baseline
    mmcif:
      > data_9XYZ
      > # 
      > loop_
      > _atom_site.auth_asym_id 
      > _atom_site.label_asym_id 
      > _atom_site.label_entity_id 
      > _atom_site.label_alt_id 
      > _atom_site.label_seq_id 
      > _atom_site.label_comp_id 
      > _atom_site.label_atom_id 
      > _atom_site.type_symbol 
      > _atom_site.Cartn_x 
      > _atom_site.Cartn_y 
      > _atom_site.Cartn_z 
      > _atom_site.occupancy 
      > _atom_site.B_iso_or_equiv 
      > AAA A 1 . 1 GLY N  N -1.195  0.201 -0.206 1.00 0.00
      > AAA A 1 . 1 GLY CA C  0.230  0.318 -0.502 1.00 0.00
      > AAA A 1 . 1 GLY C  C  1.059 -0.390  0.542 1.00 0.00
      > AAA A 1 . 1 GLY O  O  0.545 -0.975  1.499 1.00 0.00
    model_id: 1
    assembly_id: 1
    expected:
      > symmetry_mate,chain_id,subchain_id,entity_id,alt_id,seq_id,seq_label,comp_id,atom_id,element,x,y,z,occupancy,b_factor
      > 0,AAA,A,1,,1,,GLY,N, N,-1.195, 0.201,-0.206,1.00,0.00
      > 0,AAA,A,1,,1,,GLY,CA,C, 0.230, 0.318,-0.502,1.00,0.00
      > 0,AAA,A,1,,1,,GLY,C, C, 1.059,-0.390, 0.542,1.00,0.00
      > 0,AAA,A,1,,1,,GLY,O, O, 0.545,-0.975, 1.499,1.00,0.00
  -
    id: parse-model-6dze
    mmcif:
      > data_6DZE
      > # 
      > loop_
      > _atom_site.group_PDB 
      > _atom_site.id 
      > _atom_site.type_symbol 
      > _atom_site.label_atom_id 
      > _atom_site.label_alt_id 
      > _atom_site.label_comp_id 
      > _atom_site.label_asym_id 
      > _atom_site.label_entity_id 
      > _atom_site.label_seq_id 
      > _atom_site.pdbx_PDB_ins_code 
      > _atom_site.Cartn_x 
      > _atom_site.Cartn_y 
      > _atom_site.Cartn_z 
      > _atom_site.occupancy 
      > _atom_site.B_iso_or_equiv 
      > _atom_site.pdbx_formal_charge 
      > _atom_site.auth_seq_id 
      > _atom_site.auth_comp_id 
      > _atom_site.auth_asym_id 
      > _atom_site.auth_atom_id 
      > _atom_site.pdbx_PDB_model_num 
      > ATOM   1    N N    . GLY A 1 1  ? 7.443   2.693  -0.227  1.00 0.00 ? 1  GLY A N    1  
      > ATOM   2    C CA   . GLY A 1 1  ? 7.583   3.413  1.035   1.00 0.00 ? 1  GLY A CA   1  
      > ATOM   3    C C    . GLY A 1 1  ? 7.765   2.443  2.197   1.00 0.00 ? 1  GLY A C    1  
      > ATOM   4    O O    . GLY A 1 1  ? 8.884   2.044  2.516   1.00 0.00 ? 1  GLY A O    1  
      > ATOM   294  N N    . GLY A 1 1  ? 5.942   3.401  2.220   1.00 0.00 ? 1  GLY A N    2  
      > ATOM   295  C CA   . GLY A 1 1  ? 6.203   3.065  3.615   1.00 0.00 ? 1  GLY A CA   2  
      > ATOM   296  C C    . GLY A 1 1  ? 5.823   1.618  3.907   1.00 0.00 ? 1  GLY A C    2  
      > ATOM   297  O O    . GLY A 1 1  ? 4.682   1.209  3.689   1.00 0.00 ? 1  GLY A O    2  
      > ATOM   587  N N    . GLY A 1 1  ? 7.919   2.798  0.980   1.00 0.00 ? 1  GLY A N    3  
      > ATOM   588  C CA   . GLY A 1 1  ? 9.331   2.705  1.337   1.00 0.00 ? 1  GLY A CA   3  
      > ATOM   589  C C    . GLY A 1 1  ? 9.724   1.260  1.625   1.00 0.00 ? 1  GLY A C    3  
      > ATOM   590  O O    . GLY A 1 1  ? 9.929   0.468  0.705   1.00 0.00 ? 1  GLY A O    3  
    model_id: 2
    assembly_id: 1
    expected:
      > symmetry_mate,chain_id,subchain_id,entity_id,alt_id,seq_id,seq_label,comp_id,atom_id,element,x,y,z,occupancy,b_factor
      > 0,A,A,1,,1,1,GLY,N, N,5.942,3.401,2.220,1.00,0.00 
      > 0,A,A,1,,1,1,GLY,CA,C,6.203,3.065,3.615,1.00,0.00 
      > 0,A,A,1,,1,1,GLY,C, C,5.823,1.618,3.907,1.00,0.00 
      > 0,A,A,1,,1,1,GLY,O, O,4.682,1.209,3.689,1.00,0.00 
  -
    id: parse-alt-loc-1fav
    mmcif:
      > data_1FAV
      > # 
      > loop_
      > _atom_site.auth_asym_id 
      > _atom_site.label_asym_id 
      > _atom_site.label_entity_id 
      > _atom_site.label_alt_id 
      > _atom_site.label_seq_id 
      > _atom_site.label_comp_id 
      > _atom_site.label_atom_id 
      > _atom_site.type_symbol 
      > _atom_site.Cartn_x 
      > _atom_site.Cartn_y 
      > _atom_site.Cartn_z 
      > _atom_site.occupancy 
      > _atom_site.B_iso_or_equiv 
      > BBB B 2 A 1 3PA C1A C 8.927  8.112  76.619  0.50 60.83
      > BBB B 2 B 1 3PA C1A C 12.166 8.592  73.991  0.50 62.56
    model_id: 1
    assembly_id: 1
    expected:
      > symmetry_mate,chain_id,subchain_id,entity_id,alt_id,seq_id,seq_label,comp_id,atom_id,element,x,y,z,occupancy,b_factor
      > 0,BBB,B,2,A,1,,3PA,C1A,C, 8.927,8.112,76.619,0.50,60.83
      > 0,BBB,B,2,B,1,,3PA,C1A,C,12.166,8.592,73.991,0.50,62.56
  -
    id: parse-missing-seq-id-5d8v
    mmcif:
      > data_5D8V
      > # 
      > loop_
      > _atom_site.group_PDB 
      > _atom_site.id 
      > _atom_site.type_symbol 
      > _atom_site.label_atom_id 
      > _atom_site.label_alt_id 
      > _atom_site.label_comp_id 
      > _atom_site.label_asym_id 
      > _atom_site.label_entity_id 
      > _atom_site.label_seq_id 
      > _atom_site.pdbx_PDB_ins_code 
      > _atom_site.Cartn_x 
      > _atom_site.Cartn_y 
      > _atom_site.Cartn_z 
      > _atom_site.occupancy 
      > _atom_site.B_iso_or_equiv 
      > _atom_site.pdbx_formal_charge 
      > _atom_site.auth_seq_id 
      > _atom_site.auth_comp_id 
      > _atom_site.auth_asym_id 
      > _atom_site.auth_atom_id 
      > _atom_site.pdbx_PDB_model_num 
      > ATOM   847  N  N    . CYS A 1 43 ? 19.548 21.174 2.193   1.00 2.42  ? 43  CYS A N    1 
      > ATOM   848  C  CA   . CYS A 1 43 ? 18.915 21.622 3.425   1.00 2.35  ? 43  CYS A CA   1 
      > ATOM   849  C  C    . CYS A 1 43 ? 17.568 22.304 3.171   1.00 2.41  ? 43  CYS A C    1 
      > ATOM   850  O  O    . CYS A 1 43 ? 16.649 22.179 3.981   1.00 2.70  ? 43  CYS A O    1 
      > ATOM   851  C  CB   . CYS A 1 43 ? 19.835 22.572 4.185   1.00 2.55  ? 43  CYS A CB   1 
      > ATOM   852  S  SG   . CYS A 1 43 ? 21.395 21.804 4.744   1.00 2.51  ? 43  CYS A SG   1 
      > HETATM 1669 FE FE1  . SF4 B 2 .  ? 20.757 20.303 6.303   1.00 2.32  ? 84  SF4 A FE1  1 
      > HETATM 1670 FE FE2  . SF4 B 2 .  ? 18.705 18.673 7.122   1.00 2.31  ? 84  SF4 A FE2  1 
      > HETATM 1671 FE FE3  . SF4 B 2 .  ? 20.166 20.036 8.941   1.00 2.40  ? 84  SF4 A FE3  1 
      > HETATM 1672 FE FE4  . SF4 B 2 .  ? 21.284 17.975 7.559   1.00 2.33  ? 84  SF4 A FE4  1 
      > HETATM 1673 S  S1   . SF4 B 2 .  ? 19.506 17.818 9.005   1.00 2.53  ? 84  SF4 A S1   1 
      > HETATM 1674 S  S2   . SF4 B 2 .  ? 22.247 20.032 7.934   1.00 2.47  ? 84  SF4 A S2   1 
      > HETATM 1675 S  S3   . SF4 B 2 .  ? 20.291 18.166 5.527   1.00 2.40  ? 84  SF4 A S3   1 
      > HETATM 1676 S  S4   . SF4 B 2 .  ? 18.833 20.972 7.390   1.00 2.46  ? 84  SF4 A S4   1 
    model_id: 1
    assembly_id: 1
    expected:
      > symmetry_mate,chain_id,subchain_id,entity_id,alt_id,seq_id,seq_label,comp_id,atom_id,element,x,y,z,occupancy,b_factor
      > 0,A,A,1,,43,43,CYS,N,N,19.548,21.174,2.193,1.00,2.42
      > 0,A,A,1,,43,43,CYS,CA,C,18.915,21.622,3.425,1.00,2.35
      > 0,A,A,1,,43,43,CYS,C,C,17.568,22.304,3.171,1.00,2.41
      > 0,A,A,1,,43,43,CYS,O,O,16.649,22.179,3.981,1.00,2.70
      > 0,A,A,1,,43,43,CYS,CB,C,19.835,22.572,4.185,1.00,2.55
      > 0,A,A,1,,43,43,CYS,SG,S,21.395,21.804,4.744,1.00,2.51
      > 0,A,B,2,,,84,SF4,FE1,FE,20.757,20.303,6.303,1.00,2.32
      > 0,A,B,2,,,84,SF4,FE2,FE,18.705,18.673,7.122,1.00,2.31
      > 0,A,B,2,,,84,SF4,FE3,FE,20.166,20.036,8.941,1.00,2.40
      > 0,A,B,2,,,84,SF4,FE4,FE,21.284,17.975,7.559,1.00,2.33
      > 0,A,B,2,,,84,SF4,S1,S,19.506,17.818,9.005,1.00,2.53
      > 0,A,B,2,,,84,SF4,S2,S,22.247,20.032,7.934,1.00,2.47
      > 0,A,B,2,,,84,SF4,S3,S,20.291,18.166,5.527,1.00,2.40
      > 0,A,B,2,,,84,SF4,S4,S,18.833,20.972,7.390,1.00,2.46
  -
    id: parse-dna-atom-ids-1bna
    mmcif:
      > data_1BNA
      > # 
      > loop_
      > _atom_site.group_PDB 
      > _atom_site.id 
      > _atom_site.type_symbol 
      > _atom_site.label_atom_id 
      > _atom_site.label_alt_id 
      > _atom_site.label_comp_id 
      > _atom_site.label_asym_id 
      > _atom_site.label_entity_id 
      > _atom_site.label_seq_id 
      > _atom_site.pdbx_PDB_ins_code 
      > _atom_site.Cartn_x 
      > _atom_site.Cartn_y 
      > _atom_site.Cartn_z 
      > _atom_site.occupancy 
      > _atom_site.B_iso_or_equiv 
      > _atom_site.pdbx_formal_charge 
      > _atom_site.auth_seq_id 
      > _atom_site.auth_comp_id 
      > _atom_site.auth_asym_id 
      > _atom_site.auth_atom_id 
      > _atom_site.pdbx_PDB_model_num 
      > ATOM   1   O "O5'" . DC  A 1 1  ? 18.935 34.195 25.617  1.00 64.35 ? 1   DC  A "O5'" 1 
      > ATOM   2   C "C5'" . DC  A 1 1  ? 19.130 33.921 24.219  1.00 44.69 ? 1   DC  A "C5'" 1 
      > ATOM   3   C "C4'" . DC  A 1 1  ? 19.961 32.668 24.100  1.00 31.28 ? 1   DC  A "C4'" 1 
      > ATOM   4   O "O4'" . DC  A 1 1  ? 19.360 31.583 24.852  1.00 37.45 ? 1   DC  A "O4'" 1 
      > ATOM   5   C "C3'" . DC  A 1 1  ? 20.172 32.122 22.694  1.00 46.72 ? 1   DC  A "C3'" 1 
      > ATOM   6   O "O3'" . DC  A 1 1  ? 21.350 31.325 22.681  1.00 48.89 ? 1   DC  A "O3'" 1 
      > ATOM   7   C "C2'" . DC  A 1 1  ? 18.948 31.223 22.647  1.00 30.88 ? 1   DC  A "C2'" 1 
      > ATOM   8   C "C1'" . DC  A 1 1  ? 19.231 30.482 23.944  1.00 36.58 ? 1   DC  A "C1'" 1 
      > ATOM   9   N N1    . DC  A 1 1  ? 18.070 29.661 24.380  1.00 40.51 ? 1   DC  A N1    1 
      > ATOM   10  C C2    . DC  A 1 1  ? 18.224 28.454 25.015  1.00 16.62 ? 1   DC  A C2    1 
      > ATOM   11  O O2    . DC  A 1 1  ? 19.360 28.014 25.214  1.00 27.75 ? 1   DC  A O2    1 
      > ATOM   12  N N3    . DC  A 1 1  ? 17.143 27.761 25.377  1.00 20.55 ? 1   DC  A N3    1 
      > ATOM   13  C C4    . DC  A 1 1  ? 15.917 28.226 25.120  1.00 34.72 ? 1   DC  A C4    1 
      > ATOM   14  N N4    . DC  A 1 1  ? 14.828 27.477 25.444  1.00 40.31 ? 1   DC  A N4    1 
      > ATOM   15  C C5    . DC  A 1 1  ? 15.719 29.442 24.471  1.00 30.78 ? 1   DC  A C5    1 
      > ATOM   16  C C6    . DC  A 1 1  ? 16.843 30.171 24.101  1.00 25.90 ? 1   DC  A C6    1 
    model_id: 1
    assembly_id: 1
    expected:
      > symmetry_mate,chain_id,subchain_id,entity_id,alt_id,seq_id,seq_label,comp_id,atom_id,element,x,y,z,occupancy,b_factor
      > 0,A,A,1,,1,1,DC,O5',O,18.935,34.195,25.617,1.00,64.35
      > 0,A,A,1,,1,1,DC,C5',C,19.130,33.921,24.219,1.00,44.69
      > 0,A,A,1,,1,1,DC,C4',C,19.961,32.668,24.100,1.00,31.28
      > 0,A,A,1,,1,1,DC,O4',O,19.360,31.583,24.852,1.00,37.45
      > 0,A,A,1,,1,1,DC,C3',C,20.172,32.122,22.694,1.00,46.72
      > 0,A,A,1,,1,1,DC,O3',O,21.350,31.325,22.681,1.00,48.89
      > 0,A,A,1,,1,1,DC,C2',C,18.948,31.223,22.647,1.00,30.88
      > 0,A,A,1,,1,1,DC,C1',C,19.231,30.482,23.944,1.00,36.58
      > 0,A,A,1,,1,1,DC,N1, N,18.070,29.661,24.380,1.00,40.51
      > 0,A,A,1,,1,1,DC,C2, C,18.224,28.454,25.015,1.00,16.62
      > 0,A,A,1,,1,1,DC,O2, O,19.360,28.014,25.214,1.00,27.75
      > 0,A,A,1,,1,1,DC,N3, N,17.143,27.761,25.377,1.00,20.55
      > 0,A,A,1,,1,1,DC,C4, C,15.917,28.226,25.120,1.00,34.72
      > 0,A,A,1,,1,1,DC,N4, N,14.828,27.477,25.444,1.00,40.31
      > 0,A,A,1,,1,1,DC,C5, C,15.719,29.442,24.471,1.00,30.78
      > 0,A,A,1,,1,1,DC,C6, C,16.843,30.171,24.101,1.00,25.90
  -
    id: assembly-identity
    mmcif:
      > data_9XYZ
      > # 
      > _pdbx_struct_assembly_gen.assembly_id       1 
      > _pdbx_struct_assembly_gen.oper_expression   1
      > _pdbx_struct_assembly_gen.asym_id_list      A
      > # 
      > loop_
      > _pdbx_struct_oper_list.id 
      > _pdbx_struct_oper_list.type 
      > _pdbx_struct_oper_list.matrix[1][1] 
      > _pdbx_struct_oper_list.matrix[1][2] 
      > _pdbx_struct_oper_list.matrix[1][3] 
      > _pdbx_struct_oper_list.vector[1] 
      > _pdbx_struct_oper_list.matrix[2][1] 
      > _pdbx_struct_oper_list.matrix[2][2] 
      > _pdbx_struct_oper_list.matrix[2][3] 
      > _pdbx_struct_oper_list.vector[2] 
      > _pdbx_struct_oper_list.matrix[3][1] 
      > _pdbx_struct_oper_list.matrix[3][2] 
      > _pdbx_struct_oper_list.matrix[3][3] 
      > _pdbx_struct_oper_list.vector[3] 
      > 1 'identity operation' 1.0000000000 0.0000000000 0.0000000000 0.0000000000 0.0000000000 1.0000000000 0.0000000000 0.0000000000 0.0000000000 0.0000000000 1.0000000000 0.0000000000 
      > # 
      > loop_
      > _atom_site.auth_asym_id 
      > _atom_site.label_asym_id 
      > _atom_site.label_entity_id 
      > _atom_site.label_alt_id 
      > _atom_site.label_seq_id 
      > _atom_site.label_comp_id 
      > _atom_site.label_atom_id 
      > _atom_site.type_symbol 
      > _atom_site.Cartn_x 
      > _atom_site.Cartn_y 
      > _atom_site.Cartn_z 
      > _atom_site.occupancy 
      > _atom_site.B_iso_or_equiv 
      > AAA A 1 . 1 GLY N  N -1.195  0.201 -0.206 1.00 0.00
      > AAA A 1 . 1 GLY CA C  0.230  0.318 -0.502 1.00 0.00
      > AAA A 1 . 1 GLY C  C  1.059 -0.390  0.542 1.00 0.00
      > AAA A 1 . 1 GLY O  O  0.545 -0.975  1.499 1.00 0.00
    model_id: 1
    assembly_id: 1
    expected:
      > symmetry_mate,chain_id,subchain_id,entity_id,alt_id,seq_id,seq_label,comp_id,atom_id,element,x,y,z,occupancy,b_factor
      > 0,AAA,A,1,,1,,GLY,N, N,-1.195, 0.201,-0.206,1.00,0.00
      > 0,AAA,A,1,,1,,GLY,CA,C, 0.230, 0.318,-0.502,1.00,0.00
      > 0,AAA,A,1,,1,,GLY,C, C, 1.059,-0.390, 0.542,1.00,0.00
      > 0,AAA,A,1,,1,,GLY,O, O, 0.545,-0.975, 1.499,1.00,0.00
  -
    id: assembly-exclude-subchain-2hwy
    mmcif:
      > data_2HWY
      > # 
      > loop_
      > _pdbx_struct_assembly_gen.assembly_id 
      > _pdbx_struct_assembly_gen.oper_expression 
      > _pdbx_struct_assembly_gen.asym_id_list 
      > 1 1 A 
      > 2 1 B 
      > # 
      > _pdbx_struct_oper_list.id                   1 
      > _pdbx_struct_oper_list.type                 'identity operation' 
      > _pdbx_struct_oper_list.name                 1_555 
      > _pdbx_struct_oper_list.symmetry_operation   x,y,z 
      > _pdbx_struct_oper_list.matrix[1][1]         1.0000000000 
      > _pdbx_struct_oper_list.matrix[1][2]         0.0000000000 
      > _pdbx_struct_oper_list.matrix[1][3]         0.0000000000 
      > _pdbx_struct_oper_list.vector[1]            0.0000000000 
      > _pdbx_struct_oper_list.matrix[2][1]         0.0000000000 
      > _pdbx_struct_oper_list.matrix[2][2]         1.0000000000 
      > _pdbx_struct_oper_list.matrix[2][3]         0.0000000000 
      > _pdbx_struct_oper_list.vector[2]            0.0000000000 
      > _pdbx_struct_oper_list.matrix[3][1]         0.0000000000 
      > _pdbx_struct_oper_list.matrix[3][2]         0.0000000000 
      > _pdbx_struct_oper_list.matrix[3][3]         1.0000000000 
      > _pdbx_struct_oper_list.vector[3]            0.0000000000 
      > # 
      > loop_
      > _atom_site.group_PDB 
      > _atom_site.id 
      > _atom_site.type_symbol 
      > _atom_site.label_atom_id 
      > _atom_site.label_alt_id 
      > _atom_site.label_comp_id 
      > _atom_site.label_asym_id 
      > _atom_site.label_entity_id 
      > _atom_site.label_seq_id 
      > _atom_site.pdbx_PDB_ins_code 
      > _atom_site.Cartn_x 
      > _atom_site.Cartn_y 
      > _atom_site.Cartn_z 
      > _atom_site.occupancy 
      > _atom_site.B_iso_or_equiv 
      > _atom_site.pdbx_formal_charge 
      > _atom_site.auth_seq_id 
      > _atom_site.auth_comp_id 
      > _atom_site.auth_asym_id 
      > _atom_site.auth_atom_id 
      > _atom_site.pdbx_PDB_model_num 
      > ATOM 1    N N   . PRO A 1 3   ? -7.120  12.992 30.105 1.00 22.59 ? 855  PRO A N   1 
      > ATOM 2    C CA  . PRO A 1 3   ? -6.938  12.689 28.680 1.00 22.52 ? 855  PRO A CA  1 
      > ATOM 3    C C   . PRO A 1 3   ? -5.550  12.160 28.374 1.00 22.25 ? 855  PRO A C   1 
      > ATOM 4    O O   . PRO A 1 3   ? -4.577  12.637 28.948 1.00 21.65 ? 855  PRO A O   1 
      > ATOM 5    C CB  . PRO A 1 3   ? -7.164  14.052 27.986 1.00 22.81 ? 855  PRO A CB  1 
      > ATOM 6    C CG  . PRO A 1 3   ? -6.899  15.087 29.029 1.00 22.19 ? 855  PRO A CG  1 
      > ATOM 7    C CD  . PRO A 1 3   ? -7.281  14.444 30.351 1.00 22.97 ? 855  PRO A CD  1 
      > ATOM 922  N N   . PRO B 1 3   ? 36.367  20.784 11.706 1.00 29.02 ? 855  PRO B N   1 
      > ATOM 923  C CA  . PRO B 1 3   ? 36.240  22.206 11.403 1.00 28.91 ? 855  PRO B CA  1 
      > ATOM 924  C C   . PRO B 1 3   ? 35.314  22.952 12.394 1.00 28.90 ? 855  PRO B C   1 
      > ATOM 925  O O   . PRO B 1 3   ? 35.052  22.440 13.501 1.00 29.18 ? 855  PRO B O   1 
      > ATOM 926  C CB  . PRO B 1 3   ? 35.676  22.207 9.963  1.00 29.03 ? 855  PRO B CB  1 
      > ATOM 927  C CG  . PRO B 1 3   ? 35.376  20.735 9.606  1.00 28.79 ? 855  PRO B CG  1 
      > ATOM 928  C CD  . PRO B 1 3   ? 35.452  19.972 10.888 1.00 29.19 ? 855  PRO B CD  1 
    model_id: 1
    assembly_id: 1
    expected:
      > symmetry_mate,chain_id,subchain_id,entity_id,alt_id,seq_id,seq_label,comp_id,atom_id,element,x,y,z,occupancy,b_factor
      > 0,A,A,1,,3,855,PRO,N, N,-7.120,12.992,30.105,1.00,22.59
      > 0,A,A,1,,3,855,PRO,CA,C,-6.938,12.689,28.680,1.00,22.52
      > 0,A,A,1,,3,855,PRO,C, C,-5.550,12.160,28.374,1.00,22.25
      > 0,A,A,1,,3,855,PRO,O, O,-4.577,12.637,28.948,1.00,21.65
      > 0,A,A,1,,3,855,PRO,CB,C,-7.164,14.052,27.986,1.00,22.81
      > 0,A,A,1,,3,855,PRO,CG,C,-6.899,15.087,29.029,1.00,22.19
      > 0,A,A,1,,3,855,PRO,CD,C,-7.281,14.444,30.351,1.00,22.97
  -
    id: assembly-2-fold-symmetry-4dza
    mmcif:
      > data_4DZA
      > # 
      > _pdbx_struct_assembly_gen.assembly_id       1 
      > _pdbx_struct_assembly_gen.oper_expression   1,2 
      > _pdbx_struct_assembly_gen.asym_id_list      A
      > # 
      > loop_
      > _pdbx_struct_oper_list.id 
      > _pdbx_struct_oper_list.type 
      > _pdbx_struct_oper_list.name 
      > _pdbx_struct_oper_list.symmetry_operation 
      > _pdbx_struct_oper_list.matrix[1][1] 
      > _pdbx_struct_oper_list.matrix[1][2] 
      > _pdbx_struct_oper_list.matrix[1][3] 
      > _pdbx_struct_oper_list.vector[1] 
      > _pdbx_struct_oper_list.matrix[2][1] 
      > _pdbx_struct_oper_list.matrix[2][2] 
      > _pdbx_struct_oper_list.matrix[2][3] 
      > _pdbx_struct_oper_list.vector[2] 
      > _pdbx_struct_oper_list.matrix[3][1] 
      > _pdbx_struct_oper_list.matrix[3][2] 
      > _pdbx_struct_oper_list.matrix[3][3] 
      > _pdbx_struct_oper_list.vector[3] 
      > 1 'identity operation'         1_555 x,y,z   1.0000000000 0.0000000000 0.0000000000 0.0000000000 0.0000000000 1.0000000000  
      > 0.0000000000 0.0000000000 0.0000000000 0.0000000000 1.0000000000  0.0000000000 
      > 2 'crystal symmetry operation' 4_555 x,-y,-z 1.0000000000 0.0000000000 0.0000000000 0.0000000000 0.0000000000 -1.0000000000 
      > 0.0000000000 0.0000000000 0.0000000000 0.0000000000 -1.0000000000 0.0000000000 
      > # 
      > loop_
      > _atom_site.group_PDB 
      > _atom_site.id 
      > _atom_site.type_symbol 
      > _atom_site.label_atom_id 
      > _atom_site.label_alt_id 
      > _atom_site.label_comp_id 
      > _atom_site.label_asym_id 
      > _atom_site.label_entity_id 
      > _atom_site.label_seq_id 
      > _atom_site.pdbx_PDB_ins_code 
      > _atom_site.Cartn_x 
      > _atom_site.Cartn_y 
      > _atom_site.Cartn_z 
      > _atom_site.occupancy 
      > _atom_site.B_iso_or_equiv 
      > _atom_site.pdbx_formal_charge 
      > _atom_site.auth_seq_id 
      > _atom_site.auth_comp_id 
      > _atom_site.auth_asym_id 
      > _atom_site.auth_atom_id 
      > _atom_site.pdbx_PDB_model_num 
      > ATOM   2821 N N     . ALA A 1 399 ? -17.343 -4.234  -0.815  1.00 16.39 ? 399 ALA A N     1 
      > ATOM   2822 C CA    . ALA A 1 399 ? -17.982 -2.923  -0.508  1.00 19.33 ? 399 ALA A CA    1 
      > ATOM   2823 C C     . ALA A 1 399 ? -18.227 -2.015  -1.713  1.00 19.35 ? 399 ALA A C     1 
      > ATOM   2824 O O     . ALA A 1 399 ? -19.051 -1.064  -1.630  1.00 17.35 ? 399 ALA A O     1 
      > ATOM   2825 C CB    . ALA A 1 399 ? -17.157 -2.198  0.554   1.00 19.91 ? 399 ALA A CB    1 
    model_id: 1
    assembly_id: 1
    expected:
      > symmetry_mate,chain_id,subchain_id,entity_id,alt_id,seq_id,seq_label,comp_id,atom_id,element,x,y,z,occupancy,b_factor
      > 0,A,A,1,,399,399,ALA,N,N,-17.343,-4.234,-0.815,1.00,16.39
      > 0,A,A,1,,399,399,ALA,CA,C,-17.982,-2.923,-0.508,1.00,19.33
      > 0,A,A,1,,399,399,ALA,C,C,-18.227,-2.015,-1.713,1.00,19.35
      > 0,A,A,1,,399,399,ALA,O,O,-19.051,-1.064,-1.630,1.00,17.35
      > 0,A,A,1,,399,399,ALA,CB,C,-17.157,-2.198, 0.554,1.00,19.91
      > 1,A,A,1,,399,399,ALA,N,N,-17.343,4.234,0.815,1.00,16.39
      > 1,A,A,1,,399,399,ALA,CA,C,-17.982,2.923,0.508,1.00,19.33
      > 1,A,A,1,,399,399,ALA,C,C,-18.227,2.015,1.713,1.00,19.35
      > 1,A,A,1,,399,399,ALA,O,O,-19.051,1.064,1.630,1.00,17.35
      > 1,A,A,1,,399,399,ALA,CB,C,-17.157,2.198,-0.554,1.00,19.91
  -
    id: assembly-3-fold-symmetry-1fav
    mmcif:
      > data_1FAV
      > # 
      > _pdbx_struct_assembly_gen.assembly_id       1 
      > _pdbx_struct_assembly_gen.oper_expression   1,2,3 
      > _pdbx_struct_assembly_gen.asym_id_list      A,B 
      > # 
      > loop_
      > _pdbx_struct_oper_list.id 
      > _pdbx_struct_oper_list.type 
      > _pdbx_struct_oper_list.name 
      > _pdbx_struct_oper_list.symmetry_operation 
      > _pdbx_struct_oper_list.matrix[1][1] 
      > _pdbx_struct_oper_list.matrix[1][2] 
      > _pdbx_struct_oper_list.matrix[1][3] 
      > _pdbx_struct_oper_list.vector[1] 
      > _pdbx_struct_oper_list.matrix[2][1] 
      > _pdbx_struct_oper_list.matrix[2][2] 
      > _pdbx_struct_oper_list.matrix[2][3] 
      > _pdbx_struct_oper_list.vector[2] 
      > _pdbx_struct_oper_list.matrix[3][1] 
      > _pdbx_struct_oper_list.matrix[3][2] 
      > _pdbx_struct_oper_list.matrix[3][3] 
      > _pdbx_struct_oper_list.vector[3] 
      > 1 'identity operation'         1_555 x,y,z          1.0000000000  0.0000000000  0.0000000000  0.0000000000  0.0000000000  1.0000000000 0.0000000000 0.0000000000  0.0000000000 0.0000000000 1.0000000000 0.0000000000 
      > 2 'crystal symmetry operation' 2_655 -y+1,x-y,z    -0.5000000000 -0.8660254038  0.0000000000 35.8190000000  0.8660254038 -0.5000000000 0.0000000000 0.0000000000  0.0000000000 0.0000000000 1.0000000000 0.0000000000 
      > 3 'crystal symmetry operation' 3_665 -x+y+1,-x+1,z -0.5000000000  0.8660254038  0.0000000000 17.9095000000 -0.8660254038 -0.5000000000 0.0000000000 31.0201639382 0.0000000000 0.0000000000 1.0000000000 0.0000000000 
      > # 
      > loop_
      > _atom_site.group_PDB 
      > _atom_site.id 
      > _atom_site.type_symbol 
      > _atom_site.label_atom_id 
      > _atom_site.label_alt_id 
      > _atom_site.label_comp_id 
      > _atom_site.label_asym_id 
      > _atom_site.label_entity_id 
      > _atom_site.label_seq_id 
      > _atom_site.pdbx_PDB_ins_code 
      > _atom_site.Cartn_x 
      > _atom_site.Cartn_y 
      > _atom_site.Cartn_z 
      > _atom_site.occupancy 
      > _atom_site.B_iso_or_equiv 
      > _atom_site.pdbx_formal_charge 
      > _atom_site.auth_seq_id 
      > _atom_site.auth_comp_id 
      > _atom_site.auth_asym_id 
      > _atom_site.auth_atom_id 
      > _atom_site.pdbx_PDB_model_num 
      > ATOM   535 C CA  . ILE A 1 69 ? 15.451 7.295  87.150  1.00 21.29  ? 69  ILE A CA  1 
    model_id: 1
    assembly_id: 1
    expected:
      # Coordinates from PyMOL:
      # PyMOL> set assembly, 1
      # PyMOL> fetch 1fav
      # PyMOL> iterate_state 0, /1fav/A/A/69/CA, print(f'{x:.5f},{y:.5f},{z:.5f}')
      > symmetry_mate,chain_id,subchain_id,entity_id,alt_id,seq_id,seq_label,comp_id,atom_id,element,x,y,z,occupancy,b_factor
      > 0,A,A,1,,69,69,ILE,CA,C,15.45100, 7.29500,87.15000,1.0,21.29
      > 1,A,A,1,,69,69,ILE,CA,C,21.77584, 9.73346,87.15000,1.0,21.29
      > 2,A,A,1,,69,69,ILE,CA,C,16.50166,13.99171,87.15000,1.0,21.29
  -
    id: assembly-oper-expr-2gtl
    mmcif:
      > data_2GTL
      > # 
      > loop_
      > _pdbx_struct_assembly_gen.assembly_id 
      > _pdbx_struct_assembly_gen.oper_expression 
      > _pdbx_struct_assembly_gen.asym_id_list 
      > 1 '(1-12)'        A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,AA,BA,CA,DA,EA,FA,GA,HA,IA,JA,KA,LA,MA,NA,OA,PA,QA,RA 
      > 2 1               A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,AA,BA,CA,DA,EA,FA,GA,HA,IA,JA,KA,LA,MA,NA,OA,PA,QA,RA 
      > 3 P               A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,AA,BA,CA,DA,EA,FA,GA,HA,IA,JA,KA,LA,MA,NA,OA,PA,QA,RA 
      > 4 '(X0,X1)(1-12)' A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,AA,BA,CA,DA,EA,FA,GA,HA,IA,JA,KA,LA,MA,NA,OA,PA,QA,RA 
      > # 
      > loop_
      > _pdbx_struct_oper_list.id 
      > _pdbx_struct_oper_list.type 
      > _pdbx_struct_oper_list.name 
      > _pdbx_struct_oper_list.symmetry_operation 
      > _pdbx_struct_oper_list.matrix[1][1] 
      > _pdbx_struct_oper_list.matrix[1][2] 
      > _pdbx_struct_oper_list.matrix[1][3] 
      > _pdbx_struct_oper_list.vector[1] 
      > _pdbx_struct_oper_list.matrix[2][1] 
      > _pdbx_struct_oper_list.matrix[2][2] 
      > _pdbx_struct_oper_list.matrix[2][3] 
      > _pdbx_struct_oper_list.vector[2] 
      > _pdbx_struct_oper_list.matrix[3][1] 
      > _pdbx_struct_oper_list.matrix[3][2] 
      > _pdbx_struct_oper_list.matrix[3][3] 
      > _pdbx_struct_oper_list.vector[3] 
      > P  'transform to point frame'   ? ? -0.04222503 0.93125193  0.36192110  0.89873  0.15424759  -0.35182496 0.92326967  -0.52588  
      > 0.98712954  0.09481055  -0.12878755 0.44512   
      > X0 'transform to crystal frame' ? ? 1.00000000  0.00000000  0.00000000  0.00000  0.00000000  1.00000000  0.00000000  0.00000   
      > 0.00000000  0.00000000  1.00000000  0.00000   
      > X1 'transform to crystal frame' ? ? 0.98952     0.14395     0.01155     63.79785 -0.14429    0.98878     0.03853     132.83920 
      > -0.00587    -0.03979    0.99919     216.14185 
      > 1  'point symmetry operation'   ? ? 1.00000000  0.00000000  0.00000000  0.00000  0.00000000  1.00000000  0.00000000  0.00000   
      > 0.00000000  0.00000000  1.00000000  0.00000   
      > 2  'point symmetry operation'   ? ? 0.98721236  0.15832844  0.01854335  0.16036  -0.06473814 0.50449453  -0.86098447 -0.36070  
      > -0.14567334 0.84877405  0.50829311  0.96356   
      > 3  'point symmetry operation'   ? ? 0.96163709  0.25191873  -0.10858665 0.27942  0.02885215  -0.48651643 -0.87319488 -1.38266  
      > -0.27280333 0.83656363  -0.47512066 1.12382   
      > 4  'point symmetry operation'   ? ? 0.94884945  0.18718059  -0.25425999 0.23813  0.18718058  -0.98202192 -0.02442084 -2.04392  
      > -0.25425998 -0.02442084 -0.96682753 0.32052   
      > 5  'point symmetry operation'   ? ? 0.96163709  0.02885215  -0.27280334 0.07777  0.25191873  -0.48651645 0.83656363  -1.68322  
      > -0.10858664 -0.87319489 -0.47512064 -0.64304  
      > 6  'point symmetry operation'   ? ? 0.98721236  -0.06473814 -0.14567334 -0.04129 0.15832843  0.50449451  0.84877405  -0.66126  
      > 0.01854335  -0.86098447 0.50829312  -0.80330  
      > 7  'point symmetry operation'   ? ? -0.99643409 -0.07864428 -0.03056426 -0.71655 -0.07864428 0.73446032  0.67407945  -0.45444  
      > -0.03056426 0.67407946  -0.73802623 1.08571   
      > 8  'point symmetry operation'   ? ? -0.97414837 -0.22338161 0.03369868  -0.87742 -0.22338161 0.93022073  -0.29118732 -0.08245  
      > 0.03369868  -0.29118730 -0.95607236 0.12654   
      > 9  'point symmetry operation'   ? ? -0.95213901 -0.23832762 0.19139293  -0.92059 -0.23832762 0.18677137  -0.95305635 -0.73438  
      > 0.19139293  -0.95305635 -0.23463236 -0.68426  
      > 10 'point symmetry operation'   ? ? -0.95241536 -0.10853631 0.28482425  -0.80288 -0.10853630 -0.75243840 -0.64965861 -1.75829  
      > 0.28482424  -0.64965863 0.70485376  -0.53589  
      > 11 'point symmetry operation'   ? ? -0.97470108 0.03620102  0.22056131  -0.64202 0.03620102  -0.94819881 0.31560815  -2.13028  
      > 0.22056130  0.31560814  0.92289989  0.42329   
      > 12 'point symmetry operation'   ? ? -0.99671045 0.05114704  0.06286705  -0.59885 0.05114703  -0.20474945 0.97747718  -1.47835  
      > 0.06286705  0.97747718  0.20145990  1.23408   
      > # 
      > loop_
      > _atom_site.group_PDB 
      > _atom_site.id 
      > _atom_site.type_symbol 
      > _atom_site.label_atom_id 
      > _atom_site.label_alt_id 
      > _atom_site.label_comp_id 
      > _atom_site.label_asym_id 
      > _atom_site.label_entity_id 
      > _atom_site.label_seq_id 
      > _atom_site.pdbx_PDB_ins_code 
      > _atom_site.Cartn_x 
      > _atom_site.Cartn_y 
      > _atom_site.Cartn_z 
      > _atom_site.occupancy 
      > _atom_site.B_iso_or_equiv 
      > _atom_site.pdbx_formal_charge 
      > _atom_site.auth_seq_id 
      > _atom_site.auth_comp_id 
      > _atom_site.auth_asym_id 
      > _atom_site.auth_atom_id 
      > _atom_site.pdbx_PDB_model_num 
      > ATOM   1     N  N   . ASP A  1  5   ? 13.713  113.012 45.193  1.00 121.78 ? 5   ASP A N   1 
    model_id: 1
    assembly_id: 4
    expected:
      # Coordinates from PyMOL:
      # PyMOL> set assembly, 4
      # PyMOL> fetch 2gtl
      # PyMOL> iterate_state 0, A/5/N, print(f'{x:.5f},{y:.5f},{z:.5f}')
      > symmetry_mate,chain_id,subchain_id,entity_id,alt_id,seq_id,seq_label,comp_id,atom_id,element,x,y,z,occupancy,b_factor
      > 0, A,A,1,,5,5,ASP,N,N, 13.71300, 113.01200,  45.19300,1.0,121.78
      > 1, A,A,1,,5,5,ASP,N,N, 32.42905,  16.85502, 117.85889,1.0,121.78
      > 2, A,A,1,,5,5,ASP,N,N, 37.02883, -95.43150,  70.45247,1.0,121.78
      > 3, A,A,1,,5,5,ASP,N,N, 22.91258,-111.56103, -49.61983,1.0,121.78
      > 4, A,A,1,,5,5,ASP,N,N,  4.19654, -15.40403,-122.28573,1.0,121.78
      > 5, A,A,1,,5,5,ASP,N,N, -0.40325,  96.88247, -74.87930,1.0,121.78
      > 6, A,A,1,,5,5,ASP,N,N,-24.64969, 111.93362,  43.49203,1.0,121.78
      > 7, A,A,1,,5,5,ASP,N,N,-37.95778,  88.82079, -75.52679,1.0,121.78
      > 8, A,A,1,,5,5,ASP,N,N,-32.26153, -25.96664,-116.37023,1.0,121.78
      > 9, A,A,1,,5,5,ASP,N,N,-13.25720,-117.64124, -38.19486,1.0,121.78
      > 10,A,A,1,,5,5,ASP,N,N,  0.05088, -94.52843,  80.82397,1.0,121.78
      > 11,A,A,1,,5,5,ASP,N,N, -5.64536,  20.25901, 121.66740,1.0,121.78
      > 12,A,A,1,,5,5,ASP,N,N, 94.15720, 244.34586, 256.72101,1.0,121.78
      > 13,A,A,1,,5,5,ASP,N,N, 99.67459, 149.36702, 333.04425,1.0,121.78
      > 14,A,A,1,,5,5,ASP,N,N, 87.51498,  35.85008, 290.11710,1.0,121.78
      > 15,A,A,1,,5,5,ASP,N,N, 69.83799,  17.31198, 170.86671,1.0,121.78
      > 16,A,A,1,,5,5,ASP,N,N, 64.32060, 112.29082,  94.54346,1.0,121.78
      > 17,A,A,1,,5,5,ASP,N,N, 76.48021, 225.80774, 137.47061,1.0,121.78
      > 18,A,A,1,,5,5,ASP,N,N, 56.02167, 248.74939, 255.28951,1.0,121.78
      > 19,A,A,1,,5,5,ASP,N,N, 38.15129, 223.23032, 137.36487,1.0,121.78
      > 20,A,A,1,,5,5,ASP,N,N, 26.79245, 107.33518, 101.08846,1.0,121.78
      > 21,A,A,1,,5,5,ASP,N,N, 33.30398,  16.95912, 182.73669,1.0,121.78
      > 22,A,A,1,,5,5,ASP,N,N, 51.17435,  42.47820, 300.66132,1.0,121.78
      > 23,A,A,1,,5,5,ASP,N,N, 62.53320, 158.37332, 336.93774,1.0,121.78
  -
    id: err-unknown-assembly
    mmcif:
      > data_9XYZ
      > # 
      > loop_
      > _atom_site.auth_asym_id 
      > _atom_site.label_asym_id 
      > _atom_site.label_alt_id 
      > _atom_site.label_seq_id 
      > _atom_site.label_comp_id 
      > _atom_site.label_atom_id 
      > _atom_site.type_symbol 
      > _atom_site.Cartn_x 
      > _atom_site.Cartn_y 
      > _atom_site.Cartn_z 
      > _atom_site.occupancy 
      > _atom_site.B_iso_or_equiv 
      > AAA A . 1 GLY N  N -1.195  0.201 -0.206 1.00 0.00
      > AAA A . 1 GLY CA C  0.230  0.318 -0.502 1.00 0.00
      > AAA A . 1 GLY C  C  1.059 -0.390  0.542 1.00 0.00
      > AAA A . 1 GLY O  O  0.545 -0.975  1.499 1.00 0.00
    model_id: 1
    assembly_id: 2
    error:
      type: mmdf.MmcifError
      message:
        - can't find biological assembly
        - known assemblies: ['1']
        - unknown assembly: '2'
      pattern:
        - path: .*/mock\.cif
  -
    id: err-missing-assembly-operation
    mmcif:
      > data_9XYZ
      > # 
      > _pdbx_struct_assembly_gen.assembly_id       1 
      > _pdbx_struct_assembly_gen.oper_expression   1,2,3
      > _pdbx_struct_assembly_gen.asym_id_list      A
      > # 
      > loop_
      > _pdbx_struct_oper_list.id 
      > _pdbx_struct_oper_list.type 
      > _pdbx_struct_oper_list.name 
      > _pdbx_struct_oper_list.symmetry_operation 
      > _pdbx_struct_oper_list.matrix[1][1] 
      > _pdbx_struct_oper_list.matrix[1][2] 
      > _pdbx_struct_oper_list.matrix[1][3] 
      > _pdbx_struct_oper_list.vector[1] 
      > _pdbx_struct_oper_list.matrix[2][1] 
      > _pdbx_struct_oper_list.matrix[2][2] 
      > _pdbx_struct_oper_list.matrix[2][3] 
      > _pdbx_struct_oper_list.vector[2] 
      > _pdbx_struct_oper_list.matrix[3][1] 
      > _pdbx_struct_oper_list.matrix[3][2] 
      > _pdbx_struct_oper_list.matrix[3][3] 
      > _pdbx_struct_oper_list.vector[3] 
      > 1 'identity operation'         1_555 x,y,z   1.0000000000 0.0000000000 0.0000000000 0.0000000000 0.0000000000 1.0000000000  
      > 0.0000000000 0.0000000000 0.0000000000 0.0000000000 1.0000000000  0.0000000000 
      > # 
      > loop_
      > _atom_site.auth_asym_id 
      > _atom_site.label_asym_id 
      > _atom_site.label_alt_id 
      > _atom_site.label_seq_id 
      > _atom_site.label_comp_id 
      > _atom_site.label_atom_id 
      > _atom_site.type_symbol 
      > _atom_site.Cartn_x 
      > _atom_site.Cartn_y 
      > _atom_site.Cartn_z 
      > _atom_site.occupancy 
      > _atom_site.B_iso_or_equiv 
      > AAA A . 1 GLY N  N -1.195  0.201 -0.206 1.00 0.00
      > AAA A . 1 GLY CA C  0.230  0.318 -0.502 1.00 0.00
      > AAA A . 1 GLY C  C  1.059 -0.390  0.542 1.00 0.00
      > AAA A . 1 GLY O  O  0.545 -0.975  1.499 1.00 0.00
    model_id: 1
    assembly_id: 1
    error:
      type: mmdf.MmcifError
      message:
        - missing assembly operation
        - assembly: 1
        - operations referenced but not defined: 2,3
      pattern:
        - path: .*/mock\.cif

test_read_asymmetric_unit:
  -
    id: model-6dze
    mmcif:
      > data_6DZE
      > # 
      > loop_
      > _atom_site.group_PDB 
      > _atom_site.id 
      > _atom_site.type_symbol 
      > _atom_site.label_atom_id 
      > _atom_site.label_alt_id 
      > _atom_site.label_comp_id 
      > _atom_site.label_asym_id 
      > _atom_site.label_entity_id 
      > _atom_site.label_seq_id 
      > _atom_site.pdbx_PDB_ins_code 
      > _atom_site.Cartn_x 
      > _atom_site.Cartn_y 
      > _atom_site.Cartn_z 
      > _atom_site.occupancy 
      > _atom_site.B_iso_or_equiv 
      > _atom_site.pdbx_formal_charge 
      > _atom_site.auth_seq_id 
      > _atom_site.auth_comp_id 
      > _atom_site.auth_asym_id 
      > _atom_site.auth_atom_id 
      > _atom_site.pdbx_PDB_model_num 
      > ATOM   1    N N    . GLY A 1 1  ? 7.443   2.693  -0.227  1.00 0.00 ? 1  GLY A N    1  
      > ATOM   2    C CA   . GLY A 1 1  ? 7.583   3.413  1.035   1.00 0.00 ? 1  GLY A CA   1  
      > ATOM   3    C C    . GLY A 1 1  ? 7.765   2.443  2.197   1.00 0.00 ? 1  GLY A C    1  
      > ATOM   4    O O    . GLY A 1 1  ? 8.884   2.044  2.516   1.00 0.00 ? 1  GLY A O    1  
      > ATOM   294  N N    . GLY A 1 1  ? 5.942   3.401  2.220   1.00 0.00 ? 1  GLY A N    2  
      > ATOM   295  C CA   . GLY A 1 1  ? 6.203   3.065  3.615   1.00 0.00 ? 1  GLY A CA   2  
      > ATOM   296  C C    . GLY A 1 1  ? 5.823   1.618  3.907   1.00 0.00 ? 1  GLY A C    2  
      > ATOM   297  O O    . GLY A 1 1  ? 4.682   1.209  3.689   1.00 0.00 ? 1  GLY A O    2  
      > ATOM   587  N N    . GLY A 1 1  ? 7.919   2.798  0.980   1.00 0.00 ? 1  GLY A N    3  
      > ATOM   588  C CA   . GLY A 1 1  ? 9.331   2.705  1.337   1.00 0.00 ? 1  GLY A CA   3  
      > ATOM   589  C C    . GLY A 1 1  ? 9.724   1.260  1.625   1.00 0.00 ? 1  GLY A C    3  
      > ATOM   590  O O    . GLY A 1 1  ? 9.929   0.468  0.705   1.00 0.00 ? 1  GLY A O    3  
    # include all models
    expected:
      > model_id,chain_id,subchain_id,entity_id,alt_id,seq_id,seq_label,comp_id,atom_id,element,x,y,z,occupancy,b_factor
      > 1,A,A,1,,1,1,GLY,N, N,7.443,2.693,-0.227,1.00,0.00 
      > 1,A,A,1,,1,1,GLY,CA,C,7.583,3.413, 1.035,1.00,0.00 
      > 1,A,A,1,,1,1,GLY,C, C,7.765,2.443, 2.197,1.00,0.00 
      > 1,A,A,1,,1,1,GLY,O, O,8.884,2.044, 2.516,1.00,0.00 
      > 2,A,A,1,,1,1,GLY,N, N,5.942,3.401, 2.220,1.00,0.00 
      > 2,A,A,1,,1,1,GLY,CA,C,6.203,3.065, 3.615,1.00,0.00 
      > 2,A,A,1,,1,1,GLY,C, C,5.823,1.618, 3.907,1.00,0.00 
      > 2,A,A,1,,1,1,GLY,O, O,4.682,1.209, 3.689,1.00,0.00 
      > 3,A,A,1,,1,1,GLY,N, N,7.919,2.798, 0.980,1.00,0.00 
      > 3,A,A,1,,1,1,GLY,CA,C,9.331,2.705, 1.337,1.00,0.00 
      > 3,A,A,1,,1,1,GLY,C, C,9.724,1.260, 1.625,1.00,0.00 
      > 3,A,A,1,,1,1,GLY,O, O,9.929,0.468, 0.705,1.00,0.00 
  -
    id: assembly-2hwy
    mmcif:
      > data_2HWY
      > # 
      > loop_
      > _pdbx_struct_assembly_gen.assembly_id 
      > _pdbx_struct_assembly_gen.oper_expression 
      > _pdbx_struct_assembly_gen.asym_id_list 
      > 1 1 A 
      > 2 1 B 
      > # 
      > _pdbx_struct_oper_list.id                   1 
      > _pdbx_struct_oper_list.type                 'identity operation' 
      > _pdbx_struct_oper_list.name                 1_555 
      > _pdbx_struct_oper_list.symmetry_operation   x,y,z 
      > _pdbx_struct_oper_list.matrix[1][1]         1.0000000000 
      > _pdbx_struct_oper_list.matrix[1][2]         0.0000000000 
      > _pdbx_struct_oper_list.matrix[1][3]         0.0000000000 
      > _pdbx_struct_oper_list.vector[1]            0.0000000000 
      > _pdbx_struct_oper_list.matrix[2][1]         0.0000000000 
      > _pdbx_struct_oper_list.matrix[2][2]         1.0000000000 
      > _pdbx_struct_oper_list.matrix[2][3]         0.0000000000 
      > _pdbx_struct_oper_list.vector[2]            0.0000000000 
      > _pdbx_struct_oper_list.matrix[3][1]         0.0000000000 
      > _pdbx_struct_oper_list.matrix[3][2]         0.0000000000 
      > _pdbx_struct_oper_list.matrix[3][3]         1.0000000000 
      > _pdbx_struct_oper_list.vector[3]            0.0000000000 
      > # 
      > loop_
      > _atom_site.group_PDB 
      > _atom_site.id 
      > _atom_site.type_symbol 
      > _atom_site.label_atom_id 
      > _atom_site.label_alt_id 
      > _atom_site.label_comp_id 
      > _atom_site.label_asym_id 
      > _atom_site.label_entity_id 
      > _atom_site.label_seq_id 
      > _atom_site.pdbx_PDB_ins_code 
      > _atom_site.Cartn_x 
      > _atom_site.Cartn_y 
      > _atom_site.Cartn_z 
      > _atom_site.occupancy 
      > _atom_site.B_iso_or_equiv 
      > _atom_site.pdbx_formal_charge 
      > _atom_site.auth_seq_id 
      > _atom_site.auth_comp_id 
      > _atom_site.auth_asym_id 
      > _atom_site.auth_atom_id 
      > _atom_site.pdbx_PDB_model_num 
      > ATOM 1    N N   . PRO A 1 3   ? -7.120  12.992 30.105 1.00 22.59 ? 855  PRO A N   1 
      > ATOM 2    C CA  . PRO A 1 3   ? -6.938  12.689 28.680 1.00 22.52 ? 855  PRO A CA  1 
      > ATOM 3    C C   . PRO A 1 3   ? -5.550  12.160 28.374 1.00 22.25 ? 855  PRO A C   1 
      > ATOM 4    O O   . PRO A 1 3   ? -4.577  12.637 28.948 1.00 21.65 ? 855  PRO A O   1 
      > ATOM 5    C CB  . PRO A 1 3   ? -7.164  14.052 27.986 1.00 22.81 ? 855  PRO A CB  1 
      > ATOM 6    C CG  . PRO A 1 3   ? -6.899  15.087 29.029 1.00 22.19 ? 855  PRO A CG  1 
      > ATOM 7    C CD  . PRO A 1 3   ? -7.281  14.444 30.351 1.00 22.97 ? 855  PRO A CD  1 
      > ATOM 922  N N   . PRO B 1 3   ? 36.367  20.784 11.706 1.00 29.02 ? 855  PRO B N   1 
      > ATOM 923  C CA  . PRO B 1 3   ? 36.240  22.206 11.403 1.00 28.91 ? 855  PRO B CA  1 
      > ATOM 924  C C   . PRO B 1 3   ? 35.314  22.952 12.394 1.00 28.90 ? 855  PRO B C   1 
      > ATOM 925  O O   . PRO B 1 3   ? 35.052  22.440 13.501 1.00 29.18 ? 855  PRO B O   1 
      > ATOM 926  C CB  . PRO B 1 3   ? 35.676  22.207 9.963  1.00 29.03 ? 855  PRO B CB  1 
      > ATOM 927  C CG  . PRO B 1 3   ? 35.376  20.735 9.606  1.00 28.79 ? 855  PRO B CG  1 
      > ATOM 928  C CD  . PRO B 1 3   ? 35.452  19.972 10.888 1.00 29.19 ? 855  PRO B CD  1 
    # include all assemblies
    expected:
      > model_id,chain_id,subchain_id,entity_id,alt_id,seq_id,seq_label,comp_id,atom_id,element,x,y,z,occupancy,b_factor
      > 1,A,A,1,,3,855,PRO,N ,N,-7.120,12.992,30.105,1.00,22.59
      > 1,A,A,1,,3,855,PRO,CA,C,-6.938,12.689,28.680,1.00,22.52
      > 1,A,A,1,,3,855,PRO,C ,C,-5.550,12.160,28.374,1.00,22.25
      > 1,A,A,1,,3,855,PRO,O ,O,-4.577,12.637,28.948,1.00,21.65
      > 1,A,A,1,,3,855,PRO,CB,C,-7.164,14.052,27.986,1.00,22.81
      > 1,A,A,1,,3,855,PRO,CG,C,-6.899,15.087,29.029,1.00,22.19
      > 1,A,A,1,,3,855,PRO,CD,C,-7.281,14.444,30.351,1.00,22.97
      > 1,B,B,1,,3,855,PRO,N ,N,36.367,20.784,11.706,1.00,29.02
      > 1,B,B,1,,3,855,PRO,CA,C,36.240,22.206,11.403,1.00,28.91
      > 1,B,B,1,,3,855,PRO,C ,C,35.314,22.952,12.394,1.00,28.90
      > 1,B,B,1,,3,855,PRO,O ,O,35.052,22.440,13.501,1.00,29.18
      > 1,B,B,1,,3,855,PRO,CB,C,35.676,22.207,9.963 ,1.00,29.03
      > 1,B,B,1,,3,855,PRO,CG,C,35.376,20.735,9.606 ,1.00,28.79
      > 1,B,B,1,,3,855,PRO,CD,C,35.452,19.972,10.888,1.00,29.19
  -
    id: occupancy-clip
    mmcif:
      > data_9XYZ
      > # 
      > loop_
      > _atom_site.auth_asym_id 
      > _atom_site.label_asym_id 
      > _atom_site.label_entity_id 
      > _atom_site.label_alt_id 
      > _atom_site.label_seq_id 
      > _atom_site.label_comp_id 
      > _atom_site.label_atom_id 
      > _atom_site.type_symbol 
      > _atom_site.Cartn_x 
      > _atom_site.Cartn_y 
      > _atom_site.Cartn_z 
      > _atom_site.occupancy 
      > _atom_site.B_iso_or_equiv 
      > AAA A 1 . 1 GLY N  N -1.195  0.201 -0.206 -1.00 0.00
      > AAA A 1 . 1 GLY CA C  0.230  0.318 -0.502  0.00 0.00
      > AAA A 1 . 1 GLY C  C  1.059 -0.390  0.542  1.00 0.00
      > AAA A 1 . 1 GLY O  O  0.545 -0.975  1.499  2.00 0.00
    expected:
      > model_id,chain_id,subchain_id,entity_id,alt_id,seq_id,seq_label,comp_id,atom_id,element,x,y,z,occupancy,b_factor
      > ,AAA,A,1,,1,,GLY,N, N,-1.195, 0.201,-0.206,0.00,0.00
      > ,AAA,A,1,,1,,GLY,CA,C, 0.230, 0.318,-0.502,0.00,0.00
      > ,AAA,A,1,,1,,GLY,C, C, 1.059,-0.390, 0.542,1.00,0.00
      > ,AAA,A,1,,1,,GLY,O, O, 0.545,-0.975, 1.499,1.00,0.00

test_parse_oper_expression:
  -
    oper_expr: 1
    expected:
      [[1]]
  -
    oper_expr: 12
    expected:
      [[12]]
  -
    oper_expr: A
    expected:
      [[A]]
  -
    oper_expr: _
    expected:
      [[_]]
  -
    oper_expr: X0
    expected:
      [[X0]]
  -
    oper_expr: -
    error: 
      type: MmcifError
      message:
        - expression: -
        - expected one of '(', 'EOF', 'oper id' at 0:0
  -
    oper_expr: ,
    error: MmcifError
  -
    oper_expr: 1,2
    expected:
      [[1],[2]]
  -
    oper_expr: A,B
    expected:
      [[A],[B]]
  -
    oper_expr: 1,
    error:
      type: MmcifError
      message:
        - expression: 1,
        - expected 'oper id' at 0:2
  -
    oper_expr: ,2
    error: MmcifError
  -
    oper_expr: 1-3
    expected:
      [[1],[2],[3]]
  -
    oper_expr: 9-11
    expected:
      [[9],[10],[11]]
  -
    oper_expr: A-B
    error: MmcifError
  -
    oper_expr: -1
    error: MmcifError
  -
    oper_expr: 1-
    error: MmcifError
  -
    oper_expr: 1,3-5
    expected:
      [[1],[3],[4],[5]]
  -
    oper_expr: 1-3,5
    expected:
      [[1],[2],[3],[5]]
  -
    oper_expr: (1)
    expected:
      [[1]]
  -
    oper_expr: (A)
    expected:
      [[A]]
  -
    oper_expr: (1
    error: MmcifError
  -
    oper_expr: 1)
    error: MmcifError
  -
    oper_expr: (1,2)
    expected:
      [[1],[2]]
  -
    oper_expr: (A,B)
    expected:
      [[A],[B]]
  -
    oper_expr: (1-3)
    expected:
      [[1],[2],[3]]
  -
    oper_expr: (1-3)
    expected:
      [[1],[2],[3]]
  -
    oper_expr: (1,3-5)
    expected:
      [[1],[3],[4],[5]]
  -
    oper_expr: (1-3,5)
    expected:
      [[1],[2],[3],[5]]
  -
    oper_expr: (1)(2)
    expected:
      [[1,2]]
  -
    oper_expr: (1)(2
    error: MmcifError
  -
    oper_expr: (1()2)
    error: MmcifError
  -
    oper_expr: (1)2)
    error: MmcifError
  -
    oper_expr: (1(2)
    error: MmcifError
  -
    oper_expr: (1,2)(3)
    expected:
      [[1,3],[2,3]]
  -
    oper_expr: (1)(2,3)
    expected:
      [[1,2],[1,3]]
  -
    oper_expr: (1,2)(3,4)
    expected:
      [[1,3],[1,4],[2,3],[2,4]]
  -
    oper_expr: (1-2)(3,4)
    expected:
      [[1,3],[1,4],[2,3],[2,4]]
  -
    oper_expr: (1,2)(3-4)
    expected:
      [[1,3],[1,4],[2,3],[2,4]]
  -
    oper_expr: (1-2)(3-4)
    expected:
      [[1,3],[1,4],[2,3],[2,4]]
  -
    oper_expr: (1-3)(4-6)
    expected:
      [[1,4],[1,5],[1,6],[2,4],[2,5],[2,6],[3,4],[3,5],[3,6]]
  -
    oper_expr: (1-2,3)(4-5,6)
    expected:
      [[1,4],[1,5],[1,6],[2,4],[2,5],[2,6],[3,4],[3,5],[3,6]]
  -
    oper_expr: (1-2,3)(4,5-6)
    expected:
      [[1,4],[1,5],[1,6],[2,4],[2,5],[2,6],[3,4],[3,5],[3,6]]
  -
    oper_expr: (1,2-3)(4-5,6)
    expected:
      [[1,4],[1,5],[1,6],[2,4],[2,5],[2,6],[3,4],[3,5],[3,6]]
  -
    oper_expr: (1,2-3)(4,5-6)
    expected:
      [[1,4],[1,5],[1,6],[2,4],[2,5],[2,6],[3,4],[3,5],[3,6]]
  -
    oper_expr: (1,2,3)(4,5,6)
    expected:
      [[1,4],[1,5],[1,6],[2,4],[2,5],[2,6],[3,4],[3,5],[3,6]]
  -
    oper_expr: (1)(2)(3)
    expected:
      [[1,2,3]]
  -
    oper_expr: (1,2)(3)(4)
    expected:
      [[1,3,4],[2,3,4]]
  -
    oper_expr: (1)(2,3)(4)
    expected:
      [[1,2,4],[1,3,4]]
  -
    oper_expr: (1)(2)(3,4)
    expected:
      [[1,2,3],[1,2,4]]

  # Some hairy examples from real structures:
  -
    id: 1h8t
    oper_expr: (X0)(1-5,11-15,21-25,36-40)
    expected:
      [[X0,1], [X0,2], [X0,3], [X0,4], [X0,5], [X0,11], [X0,12], [X0,13], [X0,14], [X0,15], [X0,21], [X0,22], [X0,23], [X0,24], [X0,25], [X0,36], [X0,37], [X0,38], [X0,39], [X0,40]]
  -
    id: 1mvm
    oper_expr: (X0,X1)(1-10,21-25,31-35,41-50)
    expected:
      [[X0,1], [X0,2], [X0,3], [X0,4], [X0,5], [X0,6], [X0,7], [X0,8], [X0,9], [X0,10], [X0,21], [X0,22], [X0,23], [X0,24], [X0,25], [X0,31], [X0,32], [X0,33], [X0,34], [X0,35], [X0,41], [X0,42], [X0,43], [X0,44], [X0,45], [X0,46], [X0,47], [X0,48], [X0,49], [X0,50], [X1,1], [X1,2], [X1,3], [X1,4], [X1,5], [X1,6], [X1,7], [X1,8], [X1,9], [X1,10], [X1,21], [X1,22], [X1,23], [X1,24], [X1,25], [X1,31], [X1,32], [X1,33], [X1,34], [X1,35], [X1,41], [X1,42], [X1,43], [X1,44], [X1,45], [X1,46], [X1,47], [X1,48], [X1,49], [X1,50]]
